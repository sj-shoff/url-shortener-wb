# URL Shortener Service

Сервис сокращения URL с возможностью сбора аналитики переходов.

## Описание

Сервис позволяет создавать короткие ссылки для длинных URL, отслеживать переходы по ним и получать подробную аналитику включая:
- Общее количество переходов
- Статистику по дням и месяцам
- Данные о User-Agent устройствах
- Информацию о последних переходах

## Функциональные требования

### Основной функционал
- POST /shorten - создание новой сокращённой ссылки
- GET /s/{alias} - переход по короткой ссылке с записью аналитики
- GET /analytics/{alias} - получение аналитики по короткой ссылке

### Дополнительный функционал
- Кэширование популярных ссылок через Redis
- Поддержка кастомных alias для коротких ссылок
- Веб-интерфейс для управления ссылками и просмотра аналитики

## Технологический стек

### Backend
- Go 1.24
- PostgreSQL для хранения данных
- Redis для кэширования
- Chi router для маршрутизации
- Zerolog для логирования

### Frontend
- HTML5/CSS3/JavaScript
- Chart.js для визуализации аналитики
- Адаптивный дизайн

### Инфраструктура
- Docker и Docker Compose для развертывания
- Goose для управления миграциями БД

## Установка и запуск

### Требования
- Docker и Docker Compose
- Go 1.24+

### Быстрый старт
1. Склонируйте репозиторий
2. Создайте файл .env на основе .env.example
3. Запустите сервисы:
```bash
make docker-up
```
4. Примените миграции:
```bash
make migrate-up
```
5. Сервис будет доступен на http://localhost:8002


## API Документация

### POST /shorten
Создание короткой ссылки.

**Request:**
```json
{
    "url": "https://example.com/very/long/url",
    "custom": "optional-custom-alias"
}
```

**Response (200 OK):**
```json
{
    "short_url": "http://localhost:8002/s/abc123",
    "alias": "abc123"
}
```

**Response (400 Bad Request):**
```json
{
    "error": "invalid url format"
}
```

### GET /s/{alias}
Перенаправление на оригинальный URL с записью аналитики.

**Response:**
- 307 Temporary Redirect на оригинальный URL
- Запись в базу данных о переходе

### GET /analytics/{alias}
Получение аналитики по короткой ссылке.

**Response (200 OK):**
```json
{
    "total_clicks": 150,
    "daily_stats": {
        "2024-01-01": 25,
        "2024-01-02": 30
    },
    "monthly_stats": {
        "2024-01": 55
    },
    "user_agent_stats": {
        "Chrome/120.0.0.0": 85,
        "Firefox/115.0": 42
    },
    "clicks": [
        {
            "user_agent": "Chrome/120.0.0.0",
            "ip_address": "192.168.1.1",
            "clicked_at": "2024-01-02T15:30:00Z"
        }
    ]
}
```

**Response (404 Not Found):**
```json
{
    "error": "url not found"
}
```

## Структура проекта
